《Flutter实战笔记》
## 1、Flutter实战
Flutter 既能保证很高的开发效率，又能获得丝滑的性能。
根据近几年实践统计，Flutter 相比原生开发，人效能提高近一倍，而性能可以接近原生。

各篇的主要内容如下。
第一篇，入门篇（第1章~第5章），包括Flutter技术的出现背景和简介、Flutter的各种类型的Widget以及如何构建UI。
通过学习本章，读者可以掌握如何使用Flutter来构建UI界面。
第二篇，进阶篇（第6章~第14章），包括可滚动组件、事件机制、动画、自定义组件、文件和网络、国际化以及Flutter
核心原理等。通过本章内容，读者可以对Flutter整体构建及原理有一个深入的认识。
第三篇，实例篇（第15章），本章主要通过一个简版的Github APP来将前面介绍的内容串起来，让开发者对一个完整的
Flutter APP开发流有个了解。

##一共15章，每天2章。
Dart
基础组件、布局类组件、容器类组件
可滚动组件、功能能型组件
事件处理与通知
动画、自定义组件
文件操作与网络请求
Flutter扩展、国际化
Flutter核心原理

## 2、原生应用程序原生开发
原生应用程序是指某一个移动平台（比如iOS或安卓）所特有的应用，使用相应平台支持的开发工具和语言，并直接
调用系统提供的SDK API。

原生开发有以下主要优势：
可访问平台全部功能（GPS、摄像头）；
速度快、性能高、可以实现复杂动画及绘制，整体用户体验好；

主要缺点：
平台特定，开发成本高；不同平台必须维护不同代码，人力成本随之变大；
内容固定，动态化弱，大多数情况下，有新功能更新时只能发版；
纯原生开发主要面临动态化和开发成本两个问题。

## 跨平台开发
跨平台框架，根据其原理，主要分为三类：
H5 + 原生（Cordova、Ionic、微信小程序）
JavaScript 开发 + 原生渲染 （React Native、Weex）
自绘UI + 原生 (Qt for mobile、Flutter)

##（1）H5+原生（Hybrid技术）
这类框架主要原理就是将 App 中需要动态变动的内容通过HTML5来实现，通过原生的网页加载控件WebView来加载。
这种 H5 + 原生 的开发模式为混合开发 ，采用混合模式开发的App我们称之为混合应用或 HTMLybrid App ，如果
一个应用的大多数功能都是 H5 实现的话，我们称其为 Web App 。
目前混合开发框架的典型代表有：Cordova、Ionic 。至少目前为止，HTMLybrid App 仍然是最通用且最成熟的跨端解决方案。

在此，我们需要提一下小程序，目前国内各家公司小程序应用层的开发技术栈是 Web 技术栈，而底层渲染方式基本都
是 WebView 和原生相结合的方式。

原生开发可以访问平台所有功能，而混合开发中，H5代码是运行在 WebView 中，而 WebView 实质上就是一个浏览器内核，
其 JavaScript 依然运行在一个权限受限的沙箱中，所以对于大多数系统能力都没有访问权限，如无法访问文件系统、不
能使用蓝牙等。所以，对于 H5 不能实现的功能，就需要原生去做了。混合框架一般都会在原生代码中预先实现一些访问
系统能力的 API ， 然后暴露给 WebView 以供 JavaScript 调用。

## （2）JavaScript开发 + 原生渲染 的跨平台框架
React Native、Weex。

## （3）自绘UI + 原生
这种技术的思路是：通过在不同平台实现一个统一接口的渲染引擎来绘制UI，而不依赖系统原生控件，所以可以做到
不同平台UI的一致性。
注意，自绘引擎解决的是 UI 的跨平台问题，如果涉及其他系统能力调用，依然要涉及原生开发。这种平台技术的优点如下：
性能高；由于自绘引擎是直接调用系统API来绘制UI，所以性能和原生控件接近。
灵活、组件库易维护、UI外观保真度和一致性高；由于UI渲染不依赖原生控件，也就不需要根据不同平台的控件单
独维护一套组件库，所以代码容易维护。由于组件库是同一套代码、同一个渲染引擎，所以在不同平台，组件显示
外观可以做到高保真和高一致性；另外，由于不依赖原生控件，也就不会受原生布局系统的限制。

Flutter 是 Google 发布的一个用于创建跨平台、高性能移动应用的框架。Flutter 和 Qt mobile 一样，都没有使
用原生控件，相反都实现了一个自绘引擎，使用自身的布局、绘制系统。

## 小结
本章主要介绍了目前移动开发中三种跨平台技术，现在我们从框架角度对比一下它们，如表1-1所示：
技术类型	            UI渲染方式	        性能	    开发效率	    动态化	        框架代表
H5 + 原生	            WebView渲染	        一般	    高	            支持	        Cordova、Ionic
JavaScript + 原生渲染	原生控件渲染	    好	        中	            支持	        RN、Weex
自绘UI + 原生	        调用系统API渲染	    好	        Flutter高, Qt低	默认不支持	    Qt、Flutter

动态化主要指是否支持动态下发代码和是否支持热更新。值得注意的是 Flutter 的Release 包默认是使用 Dart 
AOT模式编译的，所以不支持动态化，但 Dart 还有 JIT 或 snapshot 运行方式，这些模式都是支持动态化的。

## Flutter
Flutter 是 Google 推出并开源的移动应用开发框架，主打跨平台、高保真、高性能。开发者可以通过 Dart 语言
开发 App，一套代码同时运行在 iOS 和 Android平台。 Flutter 提供了丰富的组件、接口，开发者可以很快地为
Flutter 添加 Native（即原生开发，指基于平台原生语言来开发应用，flutter可以和平台原生语言混合开发） 扩展。
（1）跨平台自绘引擎
Flutter 使用自己的高性能渲染引擎来绘制 Widget（组件）
Flutter 底层使用 Skia 作为其 2D 渲染引擎，Skia 是 Google的一个 2D 图形处理函数库，包含字型、坐标转换，以及点阵图，
它们都有高效能且简洁的表现。Skia 是跨平台的，并提供了非常友好的 API，目前 Google Chrome浏览器和 Android 均采用 
Skia 作为其 2D 绘图引擎。
（2）高性能 
Flutter 高性能主要靠两点来保证：
第一：Flutter App 采用 Dart 语言开发。Dart 在 JIT（即时编译）模式下，执行速度与 JavaScript 基本持平。
但是 Dart 支持 AOT，当以 AOT模式运行时，JavaScript 便远远追不上了。执行速度的提升对高帧率下的视图数据计算很有帮助。
第二：Flutter 使用自己的渲染引擎来绘制 UI ，布局数据等由 Dart 语言直接控制，所以在布局过程中不需要像 
RN 那样要在 JavaScript 和 Native 之间通信，这在一些滑动和拖动的场景下具有明显优势。
（3）采用Dart语言开发
这个是一个很有意思但也很有争议的问题，在了解 Flutter 为什么选择了 Dart 而不是 JavaScript 之前我们先来
介绍一下之前提到过的两个概念：JIT 和 AOT。

## Flutter框架结构
从上到下可以分为三层：框架层、引擎层和嵌入层。

#1. 框架层
Flutter Framework，即框架层。这是一个纯 Dart实现的 SDK，它实现了一套基础库，自底向上，我们来简单介绍一下：

底下两层（Foundation 和 Animation、Painting、Gestures）在 Google 的一些视频中被合并为一个dart UI层，对应
的是Flutter中的dart:ui包，它是 Flutter Engine 暴露的底层UI库，提供动画、手势及绘制能力。
Rendering 层，即渲染层，这一层是一个抽象的布局层，它依赖于 Dart UI 层，渲染层会构建一棵由可渲染对象的
组成的渲染树，当动态更新这些对象时，渲染树会找出变化的部分，然后更新渲染。渲染层可以说是Flutter 框架层
中最核心的部分，它除了确定每个渲染对象的位置、大小之外还要进行坐标变换、绘制（调用底层 dart:ui ）。
Widgets 层是 Flutter 提供的的一套基础组件库，在基础组件库之上，Flutter 还提供了 Material 和 Cupertino 
两种视觉风格的组件库，它们分别实现了 Material 和 iOS 设计规范。
Flutter 框架相对较小，因为一些开发者可能会使用到的更高层级的功能已经被拆分到不同的软件包中，使用 Dart 
和 Flutter 的核心库实现，其中包括平台插件，例如 camera (opens new window)和 webview (opens new window)，
以及和平台无关的功能，例如 animations (opens new window)。
我们进行Flutter 开发时，大多数时候都是和 Flutter Framework 打交道。

#2. 引擎层
Engine，即引擎层。毫无疑问是 Flutter 的核心， 该层主要是 C++ 实现，其中包括了 Skia 引擎、Dart 运行时
（Dart runtime）、文字排版引擎等。在代码调用 dart:ui库时，调用最终会走到引擎层，然后实现真正的绘制和显示。

#3. 嵌入层
Embedder，即嵌入层。Flutter 最终渲染、交互是要依赖其所在平台的操作系统 API，嵌入层主要是将 Flutter 引擎
”安装“ 到特定平台上。嵌入层采用了当前平台的语言编写，例如 Android 使用的是 Java 和 C++， iOS 和 macOS
使用的是 Objective-C 和 Objective-C++，Windows 和 Linux 使用的是 C++。 Flutter 代码可以通过嵌入层，以
模块方式集成到现有的应用中，也可以作为应用的主体。Flutter 本身包含了各个常见平台的嵌入层，假如以后 
Flutter 要支持新的平台，则需要针对该新的平台编写一个嵌入层。

## 搭建Flutter开发环境

